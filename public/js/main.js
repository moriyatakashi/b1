(()=>{"use strict";var t={31(t,e,s){var i=s(726),h=function(t){i.apply(this,arguments)};(h.prototype=Object.create(i.prototype)).Init=function(){this.nes.SetPrgRomPage(0,0),this.nes.SetPrgRomPage(1,this.nes.PrgRomPageCount-1),this.nes.SetChrRomPage(0)},t.exports=h},726(t){var e=function(t){this.nes=t,this.MAPPER_REG=null};e.prototype.Init=function(){},e.prototype.ReadLow=function(t){return 64},e.prototype.WriteLow=function(t,e){},e.prototype.ReadPPUData=function(){return this.nes.ReadPPUData_SUB()},e.prototype.WritePPUData=function(t){this.nes.WritePPUData_SUB(t)},e.prototype.BuildBGLine=function(){this.nes.BuildBGLine_SUB()},e.prototype.BuildSpriteLine=function(){this.nes.BuildSpriteLine_SUB()},e.prototype.ReadSRAM=function(t){return this.nes.SRAM[8191&t]},e.prototype.WriteSRAM=function(t,e){this.nes.SRAM[8191&t]=e},e.prototype.Write=function(t,e){},e.prototype.HSync=function(t){},e.prototype.CPUSync=function(t){},e.prototype.SetIRQ=function(){this.nes.toIRQ|=4},e.prototype.ClearIRQ=function(){this.nes.toIRQ&=-5},e.prototype.OutEXSound=function(t){return t},e.prototype.EXSoundSync=function(t){},e.prototype.GetState=function(){null!==this.MAPPER_REG&&(this.nes.StateData.Mapper={},this.nes.StateData.Mapper.MAPPER_REG=this.MAPPER_REG.slice(0))},e.prototype.SetState=function(){if(null!==this.MAPPER_REG)for(var t=0;t<this.nes.StateData.Mapper.MAPPER_REG.length;t++)this.MAPPER_REG[t]=this.nes.StateData.Mapper.MAPPER_REG[t]},t.exports=e},795(t,e,s){var i=s(31),h=function(t){if(void 0!==window.requestAnimationFrame){var e;for(this.requestID=null,this.A=0,this.X=0,this.Y=0,this.S=0,this.P=0,this.PC=0,this.toNMI=!1,this.toIRQ=0,this.CPUClock=0,this.ZNCacheTable=new Array(256),this.ZNCacheTable[0]=2,e=1;e<256;e++)this.ZNCacheTable[e]=128&e;for(this.ZNCacheTableCMP=new Array(512),e=0;e<256;e++)this.ZNCacheTableCMP[e]=1|this.ZNCacheTable[e],this.ZNCacheTableCMP[e+256]=this.ZNCacheTable[e];for(this.ScrollRegisterFlag=!1,this.PPUAddressRegisterFlag=!1,this.HScrollTmp=0,this.PPUAddress=0,this.PPUAddressBuffer=0,this.Palette=null,this.SpriteLineBuffer=null,this.PPUReadBuffer=0,this.BgLineBuffer=null,this.SPBitArray=new Array(256),e=0;e<256;e++){this.SPBitArray[e]=new Array(256);for(var s=0;s<256;s++){this.SPBitArray[e][s]=new Array(8);for(var i=0;i<8;i++)this.SPBitArray[e][s][i]=(e<<i&128)>>>7|(s<<i&128)>>>6}}for(this.PaletteArray=[16,1,2,3,16,5,6,7,16,9,10,11,16,13,14,15],this.PpuX=0,this.PpuY=0,this.ImageData=null,this.DrawFlag=!1,this.ctx=t.getContext("2d"),this.Sprite0Line=!1,this.PrgRomPageCount=0,this.ChrRomPageCount=0,this.HMirror=!1,this.VMirror=!1,this.SramEnable=!1,this.TrainerEnable=!1,this.FourScreen=!1,this.MapperNumber=-1,this.Mapper=null,this.RAM=new Array(2048),this.SRAM=new Array(8192),this.VRAM=new Array(16),this.VRAMS=new Array(16),e=0;e<16;e++)this.VRAMS[e]=new Array(1024);this.SPRITE_RAM=new Array(256),this.ROM=new Array(4),this.PRGROM_STATE=new Array(4),this.CHRROM_STATE=new Array(8),this.PRGROM_PAGES=null,this.CHRROM_PAGES=null,this.IO1=new Array(8),this.IO2=new Array(32),this.Rom=null,this.JoyPadStrobe=!1,this.JoyPadState=[0,0],this.JoyPadBuffer=[0,0],this.isConnectedGamePad1P=!1,this.isConnectedGamePad2P=!1,this.MainClock=1789772.5,this.ApuEnabled=!1,this.WaveDatas=[],this.ApuClockCounter=0,this.ApuCpuClockCounter=0,this.canAudioContext=!1,this.WebAudioCtx=null,this.WebAudioJsNode=null,this.WebAudioGainNode=null,this.WebAudioBufferSize=0,this.FDS_WAVE_REG=[],this.FDS_LFO_REG=[],this.FDS_REG=[],this.MMC5_REG=[],this.VRC6_REG=[],this.N163_RAM=[],this.AY_REG=[],this.AY_Env_Pattern=[[0]],this.AY_Env_Volume=[0,16,23,32,45,64,90,128,181,256,362,512,724,1023,1447,2047]}else window.alert("use a brower that supports requestAnimationFrame method")};h.prototype.JOYPAD_1P=0,h.prototype.JOYPAD_2P=1,h.prototype.BUTTON_A=1,h.prototype.BUTTON_B=2,h.prototype.BUTTON_SELECT=4,h.prototype.BUTTON_START=8,h.prototype.BUTTON_UP=16,h.prototype.BUTTON_DOWN=32,h.prototype.BUTTON_LEFT=64,h.prototype.BUTTON_RIGHT=128,h.prototype.CycleTable=[7,6,2,8,3,3,5,5,3,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,6,7,6,6,2,8,3,3,5,5,4,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,6,7,6,6,2,8,3,3,5,5,3,2,2,2,3,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,6,7,6,6,2,8,3,3,5,5,4,2,2,2,5,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,6,7,2,6,2,6,3,3,3,3,2,2,2,2,4,4,4,4,2,5,2,6,4,4,4,4,2,4,2,5,5,4,5,5,2,6,2,6,3,3,3,3,2,2,2,2,4,4,4,4,2,5,2,5,4,4,4,4,2,4,2,4,4,4,4,4,2,6,2,8,3,3,5,5,2,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,6,7,2,6,2,8,3,3,5,5,2,2,2,2,4,4,6,6,2,5,2,8,4,4,6,6,2,4,2,7,4,4,6,7],h.prototype.ZEROS_ROM_PAGE=new Array(8192);for(var r=0;r<h.prototype.ZEROS_ROM_PAGE.length;r++)h.prototype.ZEROS_ROM_PAGE[r]=0;h.prototype.REG_P_NEGATIVE=128,h.prototype.REG_P_OVERFLOW=64,h.prototype.REG_P_NOTUSED=32,h.prototype.REG_P_BREAK=16,h.prototype.REG_P_DECIMAL=8,h.prototype.REG_P_INTERRUPT=4,h.prototype.REG_P_ZERO=2,h.prototype.REG_P_CARRY=1,h.prototype.IRQ_NMI_ADDR=65530,h.prototype.IRQ_RESET_ADDR=65532,h.prototype.IRQ_BRK_ADDR=65534,h.prototype.PaletteTable=[[128,128,128],[0,61,166],[0,18,176],[68,0,150],[161,0,94],[199,0,40],[186,6,0],[140,23,0],[92,47,0],[16,69,0],[5,74,0],[0,71,46],[0,65,102],[0,0,0],[5,5,5],[5,5,5],[199,199,199],[0,119,255],[33,85,255],[130,55,250],[235,47,181],[255,41,80],[255,34,0],[214,50,0],[196,98,0],[53,128,0],[5,143,0],[0,138,85],[0,153,204],[33,33,33],[9,9,9],[9,9,9],[255,255,255],[15,215,255],[105,162,255],[212,128,255],[255,69,243],[255,97,139],[255,136,51],[255,156,18],[250,188,32],[159,227,14],[43,240,53],[12,240,164],[5,251,255],[94,94,94],[13,13,13],[13,13,13],[255,255,255],[166,252,255],[179,236,255],[218,171,235],[255,168,249],[255,171,179],[255,210,176],[255,239,166],[255,247,156],[215,232,149],[166,237,175],[162,242,218],[153,255,252],[221,221,221],[17,17,17],[17,17,17]],h.prototype.Init=function(){return this.ParseHeader(),this.StorageClear(),this.StorageInit(),this.PpuInit(),this.MapperSelect()?(this.Mapper.Init(),this.CpuInit(),!0):(window.alert("Unsupported Mapper: "+this.MapperNumber),!1)},h.prototype.ParseHeader=function(){if(this.Rom)return this.PrgRomPageCount=this.Rom[4],this.ChrRomPageCount=this.Rom[5],this.HMirror=!(1&this.Rom[6]),this.VMirror=!!(1&this.Rom[6]),this.SramEnable=!!(2&this.Rom[6]),this.TrainerEnable=!!(4&this.Rom[6]),this.FourScreen=!!(8&this.Rom[6]),this.MapperNumber=this.Rom[6]>>4|240&this.Rom[7],!0},h.prototype.MapperSelect=function(){return this.Mapper=new i(this),this.MapperNumber=0,!0},h.prototype.Start=function(){return null!==this.Mapper&&null===this.requestID&&(this.Run(),!0)},h.prototype.Run=function(){this.CpuRun(),this._handleGamePads(),this.requestID=window.requestAnimationFrame(this.Run.bind(this))},h.prototype.Pause=function(){return null!==this.Mapper&&null!==this.requestID&&(window.cancelAnimationFrame(this.requestID),this.requestID=null,!0)},h.prototype.EXSoundInit=function(){},h.prototype.Init_FDS=function(){},h.prototype.Init_MMC5=function(){},h.prototype.Init_VRC6=function(){},h.prototype.Init_N163=function(){},h.prototype.Init_AY=function(){},h.prototype.ExecuteOpCode=function(t){switch(t){case 189:this.LDA(this.GetAddressAbsoluteX());break;case 162:this.LDX(this.GetAddressImmediate());break;case 166:this.LDX(this.GetAddressZeroPage());break;case 174:this.LDX(this.GetAddressAbsolute());break;case 182:this.LDX(this.GetAddressZeroPageY());break;case 190:this.LDX(this.GetAddressAbsoluteY());break;case 160:this.LDY(this.GetAddressImmediate());break;case 164:this.LDY(this.GetAddressZeroPage());break;case 172:this.LDY(this.GetAddressAbsolute());break;case 180:this.LDY(this.GetAddressZeroPageX());break;case 188:this.LDY(this.GetAddressAbsoluteX());break;case 129:this.STA(this.GetAddressIndirectX());break;case 133:this.STA(this.GetAddressZeroPage());break;case 141:this.STA(this.GetAddressAbsolute());break;case 145:this.STA(this.GetAddressIndirectY());break;case 149:this.STA(this.GetAddressZeroPageX());break;case 153:this.STA(this.GetAddressAbsoluteY());break;case 157:this.STA(this.GetAddressAbsoluteX());break;case 134:this.STX(this.GetAddressZeroPage());break;case 142:this.STX(this.GetAddressAbsolute());break;case 150:this.STX(this.GetAddressZeroPageY());break;case 132:this.STY(this.GetAddressZeroPage());break;case 140:this.STY(this.GetAddressAbsolute());break;case 148:this.STY(this.GetAddressZeroPageX());break;case 138:this.TXA();break;case 152:this.TYA();break;case 154:this.TXS();break;case 168:this.TAY();break;case 170:this.TAX();break;case 186:this.TSX();break;case 8:this.PHP();break;case 40:this.PLP();break;case 72:this.PHA();break;case 104:this.PLA();break;case 97:this.ADC(this.GetAddressIndirectX());break;case 101:this.ADC(this.GetAddressZeroPage());break;case 105:this.ADC(this.GetAddressImmediate());break;case 109:this.ADC(this.GetAddressAbsolute());break;case 113:this.ADC(this.GetAddressIndirectY());break;case 117:this.ADC(this.GetAddressZeroPageX());break;case 121:this.ADC(this.GetAddressAbsoluteY());break;case 125:this.ADC(this.GetAddressAbsoluteX());break;case 225:this.SBC(this.GetAddressIndirectX());break;case 229:this.SBC(this.GetAddressZeroPage());break;case 233:case 235:this.SBC(this.GetAddressImmediate());break;case 237:this.SBC(this.GetAddressAbsolute());break;case 241:this.SBC(this.GetAddressIndirectY());break;case 245:this.SBC(this.GetAddressZeroPageX());break;case 249:this.SBC(this.GetAddressAbsoluteY());break;case 253:this.SBC(this.GetAddressAbsoluteX());break;case 193:this.CMP(this.GetAddressIndirectX());break;case 197:this.CMP(this.GetAddressZeroPage());break;case 201:this.CMP(this.GetAddressImmediate());break;case 205:this.CMP(this.GetAddressAbsolute());break;case 209:this.CMP(this.GetAddressIndirectY());break;case 213:this.CMP(this.GetAddressZeroPageX());break;case 217:this.CMP(this.GetAddressAbsoluteY());break;case 221:this.CMP(this.GetAddressAbsoluteX());break;case 224:this.CPX(this.GetAddressImmediate());break;case 228:this.CPX(this.GetAddressZeroPage());break;case 236:this.CPX(this.GetAddressAbsolute());break;case 192:this.CPY(this.GetAddressImmediate());break;case 196:this.CPY(this.GetAddressZeroPage());break;case 204:this.CPY(this.GetAddressAbsolute());break;case 33:this.AND(this.GetAddressIndirectX());break;case 37:this.AND(this.GetAddressZeroPage());break;case 41:this.AND(this.GetAddressImmediate());break;case 45:this.AND(this.GetAddressAbsolute());break;case 49:this.AND(this.GetAddressIndirectY());break;case 53:this.AND(this.GetAddressZeroPageX());break;case 57:this.AND(this.GetAddressAbsoluteY());break;case 61:this.AND(this.GetAddressAbsoluteX());break;case 65:this.EOR(this.GetAddressIndirectX());break;case 69:this.EOR(this.GetAddressZeroPage());break;case 73:this.EOR(this.GetAddressImmediate());break;case 77:this.EOR(this.GetAddressAbsolute());break;case 81:this.EOR(this.GetAddressIndirectY());break;case 85:this.EOR(this.GetAddressZeroPageX());break;case 89:this.EOR(this.GetAddressAbsoluteY());break;case 93:this.EOR(this.GetAddressAbsoluteX());break;case 1:this.ORA(this.GetAddressIndirectX());break;case 5:this.ORA(this.GetAddressZeroPage());break;case 9:this.ORA(this.GetAddressImmediate());break;case 13:this.ORA(this.GetAddressAbsolute());break;case 17:this.ORA(this.GetAddressIndirectY());break;case 21:this.ORA(this.GetAddressZeroPageX());break;case 25:this.ORA(this.GetAddressAbsoluteY());break;case 29:this.ORA(this.GetAddressAbsoluteX());break;case 36:this.BIT(this.GetAddressZeroPage());break;case 44:this.BIT(this.GetAddressAbsolute());break;case 6:this.ASL(this.GetAddressZeroPage());break;case 10:this.A=this.ASL_Sub(this.A);break;case 14:this.ASL(this.GetAddressAbsolute());break;case 22:this.ASL(this.GetAddressZeroPageX());break;case 30:this.ASL(this.GetAddressAbsoluteX());break;case 70:this.LSR(this.GetAddressZeroPage());break;case 74:this.A=this.LSR_Sub(this.A);break;case 78:this.LSR(this.GetAddressAbsolute());break;case 86:this.LSR(this.GetAddressZeroPageX());break;case 94:this.LSR(this.GetAddressAbsoluteX());break;case 38:this.ROL(this.GetAddressZeroPage());break;case 42:this.A=this.ROL_Sub(this.A);break;case 46:this.ROL(this.GetAddressAbsolute());break;case 54:this.ROL(this.GetAddressZeroPageX());break;case 62:this.ROL(this.GetAddressAbsoluteX());break;case 102:this.ROR(this.GetAddressZeroPage());break;case 106:this.A=this.ROR_Sub(this.A);break;case 110:this.ROR(this.GetAddressAbsolute());break;case 118:this.ROR(this.GetAddressZeroPageX());break;case 126:this.ROR(this.GetAddressAbsoluteX());break;case 230:this.INC(this.GetAddressZeroPage());break;case 238:this.INC(this.GetAddressAbsolute());break;case 246:this.INC(this.GetAddressZeroPageX());break;case 254:this.INC(this.GetAddressAbsoluteX());break;case 232:this.INX();break;case 200:this.INY();break;case 198:this.DEC(this.GetAddressZeroPage());break;case 206:this.DEC(this.GetAddressAbsolute());break;case 214:this.DEC(this.GetAddressZeroPageX());break;case 222:this.DEC(this.GetAddressAbsoluteX());break;case 202:this.DEX();break;case 136:this.DEY();break;case 24:this.P&=254;break;case 88:this.P&=251;break;case 184:this.P&=191;break;case 216:this.P&=247;break;case 56:this.P|=1;break;case 120:this.P|=4;break;case 248:this.P|=8;break;case 234:this.NOP();break;case 0:this.BRK();break;case 76:this.JMP(this.GetAddressAbsolute());break;case 108:var e=this.GetAddressAbsolute(),s=e+1&255|65280&e;this.JMP(this.Get(e)|this.Get(s)<<8);break;case 32:this.JSR();break;case 96:this.RTS();break;case 64:this.RTI();break;case 16:this.BPL();break;case 48:this.BMI();break;case 80:this.BVC();break;case 112:this.BVS();break;case 144:this.BCC();break;case 176:this.BCS();break;case 208:this.BNE();break;case 240:this.BEQ();break;case 11:case 43:this.ANC(this.GetAddressImmediate());break;case 139:this.ANE(this.GetAddressImmediate());break;case 107:this.ARR(this.GetAddressImmediate());break;case 75:this.ASR(this.GetAddressImmediate());break;case 199:this.DCP(this.GetAddressZeroPage());break;case 215:this.DCP(this.GetAddressZeroPageX());break;case 207:this.DCP(this.GetAddressAbsolute());break;case 223:this.DCP(this.GetAddressAbsoluteX());break;case 219:this.DCP(this.GetAddressAbsoluteY());break;case 195:this.DCP(this.GetAddressIndirectX());break;case 211:this.DCP(this.GetAddressIndirectY());break;case 231:this.ISB(this.GetAddressZeroPage());break;case 247:this.ISB(this.GetAddressZeroPageX());break;case 239:this.ISB(this.GetAddressAbsolute());break;case 255:this.ISB(this.GetAddressAbsoluteX());break;case 251:this.ISB(this.GetAddressAbsoluteY());break;case 227:this.ISB(this.GetAddressIndirectX());break;case 243:this.ISB(this.GetAddressIndirectY());break;case 187:this.LAS(this.GetAddressAbsoluteY());break;case 167:this.LAX(this.GetAddressZeroPage());break;case 183:this.LAX(this.GetAddressZeroPageY());break;case 175:this.LAX(this.GetAddressAbsolute());break;case 191:this.LAX(this.GetAddressAbsoluteY());break;case 163:this.LAX(this.GetAddressIndirectX());break;case 179:this.LAX(this.GetAddressIndirectY());break;case 171:this.LXA(this.GetAddressImmediate());break;case 39:this.RLA(this.GetAddressZeroPage());break;case 55:this.RLA(this.GetAddressZeroPageX());break;case 47:this.RLA(this.GetAddressAbsolute());break;case 63:this.RLA(this.GetAddressAbsoluteX());break;case 59:this.RLA(this.GetAddressAbsoluteY());break;case 35:this.RLA(this.GetAddressIndirectX());break;case 51:this.RLA(this.GetAddressIndirectY());break;case 103:this.RRA(this.GetAddressZeroPage());break;case 119:this.RRA(this.GetAddressZeroPageX());break;case 111:this.RRA(this.GetAddressAbsolute());break;case 127:this.RRA(this.GetAddressAbsoluteX());break;case 123:this.RRA(this.GetAddressAbsoluteY());break;case 99:this.RRA(this.GetAddressIndirectX());break;case 115:this.RRA(this.GetAddressIndirectY());break;case 135:this.SAX(this.GetAddressZeroPage());break;case 151:this.SAX(this.GetAddressZeroPageY());break;case 143:this.SAX(this.GetAddressAbsolute());break;case 131:this.SAX(this.GetAddressIndirectX());break;case 203:this.SBX(this.GetAddressImmediate());break;case 159:this.SHA(this.GetAddressAbsoluteY());break;case 147:this.SHA(this.GetAddressIndirectY());break;case 155:this.SHS(this.GetAddressAbsoluteY());break;case 158:this.SHX(this.GetAddressAbsoluteY());break;case 156:this.SHY(this.GetAddressAbsoluteX());break;case 7:this.SLO(this.GetAddressZeroPage());break;case 23:this.SLO(this.GetAddressZeroPageX());break;case 15:this.SLO(this.GetAddressAbsolute());break;case 31:this.SLO(this.GetAddressAbsoluteX());break;case 27:this.SLO(this.GetAddressAbsoluteY());break;case 3:this.SLO(this.GetAddressIndirectX());break;case 19:this.SLO(this.GetAddressIndirectY());break;case 71:this.SRE(this.GetAddressZeroPage());break;case 87:this.SRE(this.GetAddressZeroPageX());break;case 79:this.SRE(this.GetAddressAbsolute());break;case 95:this.SRE(this.GetAddressAbsoluteX());break;case 91:this.SRE(this.GetAddressAbsoluteY());break;case 67:this.SRE(this.GetAddressIndirectX());break;case 83:this.SRE(this.GetAddressIndirectY());break;case 26:case 58:case 90:case 122:case 218:case 250:break;case 128:case 130:case 137:case 194:case 226:case 4:case 68:case 100:case 20:case 52:case 84:case 116:case 212:case 244:this.PC++;break;case 12:case 28:case 60:case 92:case 124:case 220:case 252:this.PC+=2;break;default:window.alert("Unknown opcode: "+t),this.PC--}},h.prototype.SetNegativeFlag=function(){this.P|=this.REG_P_NEGATIVE},h.prototype.ClearNegativeFlag=function(){this.P&=~this.REG_P_NEGATIVE},h.prototype.SetOverflowFlag=function(){this.P|=this.REG_P_OVERFLOW},h.prototype.ClearOverflowFlag=function(){this.P&=~this.REG_P_OVERFLOW},h.prototype.SetBreakFlag=function(){this.P|=this.REG_P_BREAK},h.prototype.ClearBreakFlag=function(){this.P&=~this.REG_P_BREAK},h.prototype.SetDecimalModeFlag=function(){this.P|=this.REG_P_DECIMAL},h.prototype.ClearDecimalModeFlag=function(){this.P&=~this.REG_P_DECIMAL},h.prototype.SetInterruptFlag=function(){this.P|=this.REG_P_INTERRUPT},h.prototype.ClearInterruptFlag=function(){this.P&=~this.REG_P_INTERRUPT},h.prototype.SetZeroFlag=function(){this.P|=this.REG_P_INTERRUPT},h.prototype.ClearZeroFlag=function(){this.P&=~this.REG_P_INTERRUPT},h.prototype.SetCarryFlag=function(){this.P|=this.REG_P_CARRY},h.prototype.ClearCarryFlag=function(){this.P&=~this.REG_P_CARRY},h.prototype.CpuReset=function(){this.S=this.S-3&255,this.P|=4,this.toNMI=!1,this.toIRQ=0,this.PC=this.Get16(this.IRQ_RESET_ADDR)},h.prototype.NMI=function(){this.CPUClock+=7,this.Push(this.PC>>8&255),this.Push(255&this.PC),this.Push(239&this.P|32),this.P=239&this.P|4,this.PC=this.Get16(this.IRQ_NMI_ADDR)},h.prototype.IRQ=function(){this.CPUClock+=7,this.Push(this.PC>>8&255),this.Push(255&this.PC),this.Push(239&this.P|32),this.P=239&this.P|4,this.PC=this.Get16(this.IRQ_BRK_ADDR)},h.prototype.BRK=function(){this.PC++,this.Push(this.PC>>8),this.Push(255&this.PC),this.Push(48|this.P),this.P|=20,this.PC=this.Get16(this.IRQ_BRK_ADDR)},h.prototype.GetAddressZeroPage=function(){return this.Get(this.PC++)},h.prototype.GetAddressImmediate=function(){return this.PC++},h.prototype.GetAddressAbsolute=function(){var t=this.Get16(this.PC);return this.PC+=2,t},h.prototype.GetAddressZeroPageX=function(){return this.GetAddressZeroPage()+this.X&255},h.prototype.GetAddressZeroPageY=function(){return this.GetAddressZeroPage()+this.Y&255},h.prototype.GetAddressIndirectX=function(){var t=this.GetAddressZeroPage()+this.X&255;return this.Get(t)|this.Get(t+1&255)<<8},h.prototype.GetAddressIndirectY=function(){var t=this.GetAddressZeroPage(),e=(t=this.Get(t)|this.Get(t+1&255)<<8)+this.Y;return(256&(e^t))>0&&(this.CPUClock+=1),e},h.prototype.GetAddressAbsoluteX=function(){var t=this.GetAddressAbsolute(),e=t+this.X;return(256&(e^t))>0&&(this.CPUClock+=1),e},h.prototype.GetAddressAbsoluteY=function(){var t=this.GetAddressAbsolute(),e=t+this.Y;return(256&(e^t))>0&&(this.CPUClock+=1),e},h.prototype.Push=function(t){this.RAM[256+this.S]=t,this.S=this.S-1&255},h.prototype.Pop=function(){return this.S=this.S+1&255,this.RAM[256+this.S]},h.prototype.LDA=function(t){this.A=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.A]},h.prototype.LDX=function(t){this.X=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.X]},h.prototype.LDY=function(t){this.Y=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.Y]},h.prototype.STA=function(t){this.Set(t,this.A)},h.prototype.STX=function(t){this.Set(t,this.X)},h.prototype.STY=function(t){this.Set(t,this.Y)},h.prototype.TXA=function(){this.A=this.X,this.P=125&this.P|this.ZNCacheTable[this.A]},h.prototype.TYA=function(){this.A=this.Y,this.P=125&this.P|this.ZNCacheTable[this.A]},h.prototype.TXS=function(){this.S=this.X},h.prototype.TAY=function(){this.Y=this.A,this.P=125&this.P|this.ZNCacheTable[this.A]},h.prototype.TAX=function(){this.X=this.A,this.P=125&this.P|this.ZNCacheTable[this.A]},h.prototype.TSX=function(){this.X=this.S,this.P=125&this.P|this.ZNCacheTable[this.X]},h.prototype.PHP=function(){this.Push(48|this.P)},h.prototype.PLP=function(){this.P=this.Pop()},h.prototype.PHA=function(){this.Push(this.A)},h.prototype.PLA=function(){this.A=this.Pop(),this.P=125&this.P|this.ZNCacheTable[this.A]},h.prototype.Adder=function(t){var e=1&this.P,s=this.A+t+e;this.P=60&this.P,this.P|=((this.A^~t)&(this.A^s)&128)>>>1,this.P|=s>>>8,this.P|=this.ZNCacheTable[255&s],this.A=255&s},h.prototype.ADC=function(t){this.Adder(this.Get(t))},h.prototype.SBC=function(t){this.Adder(255&~this.Get(t))},h.prototype.CMP=function(t){this.P=124&this.P|this.ZNCacheTableCMP[this.A-this.Get(t)&511]},h.prototype.CPX=function(t){this.P=124&this.P|this.ZNCacheTableCMP[this.X-this.Get(t)&511]},h.prototype.CPY=function(t){this.P=124&this.P|this.ZNCacheTableCMP[this.Y-this.Get(t)&511]},h.prototype.AND=function(t){this.A&=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.A]},h.prototype.EOR=function(t){this.A^=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.A]},h.prototype.ORA=function(t){this.A|=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.A]},h.prototype.BIT=function(t){var e=this.Get(t);this.P=61&this.P|2&this.ZNCacheTable[e&this.A]|192&e},h.prototype.ASL_Sub=function(t){return this.P=254&this.P|t>>7,t=t<<1&255,this.P=125&this.P|this.ZNCacheTable[t],t},h.prototype.ASL=function(t){this.Set(t,this.ASL_Sub(this.Get(t)))},h.prototype.LSR_Sub=function(t){return this.P=124&this.P|1&t,t>>=1,this.P|=this.ZNCacheTable[t],t},h.prototype.LSR=function(t){this.Set(t,this.LSR_Sub(this.Get(t)))},h.prototype.ROL_Sub=function(t){var e=t>>7;return t=t<<1&255|1&this.P,this.P=124&this.P|e|this.ZNCacheTable[t],t},h.prototype.ROL=function(t){this.Set(t,this.ROL_Sub(this.Get(t)))},h.prototype.ROR_Sub=function(t){var e=1&t;return t=t>>1|(1&this.P)<<7,this.P=124&this.P|e|this.ZNCacheTable[t],t},h.prototype.ROR=function(t){this.Set(t,this.ROR_Sub(this.Get(t)))},h.prototype.INC=function(t){var e=this.Get(t)+1&255;this.P=125&this.P|this.ZNCacheTable[e],this.Set(t,e)},h.prototype.DEC=function(t){var e=this.Get(t)-1&255;this.P=125&this.P|this.ZNCacheTable[e],this.Set(t,e)},h.prototype.INX=function(){this.X=this.X+1&255,this.P=125&this.P|this.ZNCacheTable[this.X]},h.prototype.INY=function(){this.Y=this.Y+1&255,this.P=125&this.P|this.ZNCacheTable[this.Y]},h.prototype.DEX=function(){this.X=this.X-1&255,this.P=125&this.P|this.ZNCacheTable[this.X]},h.prototype.DEY=function(){this.Y=this.Y-1&255,this.P=125&this.P|this.ZNCacheTable[this.Y]},h.prototype.NOP=function(){},h.prototype.CLC=function(){this.P&=254},h.prototype.CLC=function(){this.P&=251},h.prototype.CLV=function(){this.P&=191},h.prototype.CLD=function(){this.P&=247},h.prototype.SEC=function(){this.P|=1},h.prototype.SEI=function(){this.P|=4},h.prototype.SED=function(){this.P|=8},h.prototype.JMP=function(t){this.PC=t},h.prototype.JSR=function(){var t=this.PC+1&65535;this.Push(t>>8),this.Push(255&t),this.JMP(this.GetAddressAbsolute())},h.prototype.RTS=function(){this.PC=1+(this.Pop()|this.Pop()<<8)},h.prototype.RTI=function(){this.P=this.Pop(),this.PC=this.Pop()|this.Pop()<<8},h.prototype.BCC=function(){this.Branch(!(1&this.P))},h.prototype.BCS=function(){this.Branch(!!(1&this.P))},h.prototype.BPL=function(){this.Branch(!(128&this.P))},h.prototype.BMI=function(){this.Branch(!!(128&this.P))},h.prototype.BVC=function(){this.Branch(!(64&this.P))},h.prototype.BVS=function(){this.Branch(!!(64&this.P))},h.prototype.BNE=function(){this.Branch(!(2&this.P))},h.prototype.BEQ=function(){this.Branch(!!(2&this.P))},h.prototype.Branch=function(t){if(t){var e=this.Get(this.PC),s=this.PC+1;this.PC=s+(e>=128?e-256:e)&65535,this.CPUClock+=(256&(s^this.PC))>0?2:1}else this.PC++},h.prototype.ANC=function(t){this.A&=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.A],this.P=254&this.P|this.A>>>7},h.prototype.ANE=function(t){this.A=(238|this.A)&this.X&this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.A]},h.prototype.ARR=function(t){this.A&=this.Get(t),this.A=this.A>>1|(1&this.P)<<7,this.P=125&this.P|this.ZNCacheTable[this.A],this.P=254&this.P|(64&this.A)>>6;var e=64&(this.A^this.A<<1);this.P=191&this.P|e},h.prototype.ASR=function(t){this.A&=this.Get(t),this.P=254&this.P|1&this.A,this.A=this.A>>1,this.P=125&this.P|this.ZNCacheTable[this.A]},h.prototype.DCP=function(t){var e=this.Get(t)-1&255;this.P=124&this.P|this.ZNCacheTableCMP[this.A-e&511],this.Set(t,e)},h.prototype.ISB=function(t){var e=this.Get(t)+1&255;this.Adder(255&~e),this.Set(t,e)},h.prototype.LAS=function(t){var e=this.Get(t)&this.S;this.A=this.X=this.S=e,this.P=125&this.P|this.ZNCacheTable[this.A]},h.prototype.LAX=function(t){this.A=this.X=this.Get(t),this.P=125&this.P|this.ZNCacheTable[this.A]},h.prototype.LXA=function(t){var e=(238|this.A)&this.Get(t);this.A=this.X=e,this.P=125&this.P|this.ZNCacheTable[this.A]},h.prototype.RLA=function(t){var e=this.Get(t);e=e<<1|1&this.P,this.P=254&this.P|e>>8,this.A&=e,this.P=125&this.P|this.ZNCacheTable[this.A],this.Set(t,e)},h.prototype.RRA=function(t){var e=this.Get(t),s=1&e;e=e>>1|(1&this.P)<<7,this.P=254&this.P|s,this.Adder(e),this.Set(t,e)},h.prototype.SAX=function(t){var e=this.A&this.X;this.Set(t,e)},h.prototype.SBX=function(t){var e=(this.A&this.X)-this.Get(t);this.P=254&this.P|~e>>8&1,this.X=255&e,this.P=125&this.P|this.ZNCacheTable[this.X]},h.prototype.SHA=function(t){var e=this.A&this.X&1+(t>>8);this.Set(t,e)},h.prototype.SHS=function(t){this.S=this.A&this.X;var e=this.S&1+(t>>8);this.Set(t,e)},h.prototype.SHX=function(t){var e=this.X&1+(t>>8);this.Set(t,e)},h.prototype.SHY=function(t){var e=this.Y&1+(t>>8);this.Set(t,e)},h.prototype.SLO=function(t){var e=this.Get(t);this.P=254&this.P|e>>7,e=e<<1&255,this.A|=e,this.P=125&this.P|this.ZNCacheTable[this.A],this.Set(t,e)},h.prototype.SRE=function(t){var e=this.Get(t);this.P=254&this.P|1&e,e>>=1,this.A^=e,this.P=125&this.P|this.ZNCacheTable[this.A],this.Set(t,e)},h.prototype.PpuInit=function(){var t;for(this.ScrollRegisterFlag=!1,this.PPUAddressRegisterFlag=!1,this.HScrollTmp=0,this.PPUAddress=0,this.PPUAddressBuffer=0,this.Palette=new Array(33),t=0;t<this.Palette.length;t++)this.Palette[t]=15;for(this.SpriteLineBuffer=new Array(256),t=0;t<this.SpriteLineBuffer.length;t++)this.SpriteLineBuffer[t]=0;this.PPUReadBuffer=0,this.FourScreen?this.SetMirrors(0,1,2,3):this.SetMirror(this.HMirror),this.BgLineBuffer=new Array(264),this.PpuX=341,this.PpuY=0,this.Sprite0Line=!1},h.prototype.SetMirror=function(t){t?this.SetMirrors(0,0,1,1):this.SetMirrors(0,1,0,1)},h.prototype.SetMirrors=function(t,e,s,i){this.SetChrRomPage1K(8,t+8+256),this.SetChrRomPage1K(9,e+8+256),this.SetChrRomPage1K(10,s+8+256),this.SetChrRomPage1K(11,i+8+256)},h.prototype.SetChrRomPage1K=function(t,e){e>=256?(this.CHRROM_STATE[t]=e,this.VRAM[t]=this.VRAMS[255&e]):this.ChrRomPageCount>0&&(this.CHRROM_STATE[t]=e%(8*this.ChrRomPageCount),this.VRAM[t]=this.CHRROM_PAGES[this.CHRROM_STATE[t]])},h.prototype.SetChrRomPages1K=function(t,e,s,i,h,r,a,o){this.SetChrRomPage1K(0,t),this.SetChrRomPage1K(1,e),this.SetChrRomPage1K(2,s),this.SetChrRomPage1K(3,i),this.SetChrRomPage1K(4,h),this.SetChrRomPage1K(5,r),this.SetChrRomPage1K(6,a),this.SetChrRomPage1K(7,o)},h.prototype.SetChrRomPage=function(t){t<<=3;for(var e=0;e<8;e++)this.SetChrRomPage1K(e,t+e)},h.prototype.initCanvas=function(){if(!this.ctx)return!1;this.ImageData=this.ctx.createImageData(256,224);for(var t=0;t<229376;t+=4)this.ImageData.data[t+3]=255;return this.ctx.putImageData(this.ImageData,0,0),!0},h.prototype.PpuRun=function(){var t=this.PpuX;for(this.PpuX+=3*this.CPUClock;this.PpuX>=341;){var e,s,i,h=!(8&~this.IO1[1]),r=!(16&~this.IO1[1]);if(this.PpuX-=341,t=0,this.Sprite0Line=!1,this.PpuY++,262===this.PpuY&&(this.PpuY=0,(h||r)&&(this.PPUAddress=this.PPUAddressBuffer),this.IO1[2]&=127),this.Mapper.HSync(this.PpuY),240!==this.PpuY){if(this.PpuY<240)if(h||r){if(this.PPUAddress=64480&this.PPUAddress|1055&this.PPUAddressBuffer,8<=this.PpuY&&this.PpuY<232)for(this.BuildBGLine(),this.BuildSpriteLine(),s=this.PpuY-8<<10,e=0;e<256;e++,s+=4)i=this.PaletteTable[this.Palette[this.BgLineBuffer[e]]],this.ImageData.data[s]=i[0],this.ImageData.data[s+1]=i[1],this.ImageData.data[s+2]=i[2];else{for(e=0;e<264;e++)this.BgLineBuffer[e]=16;this.BuildSpriteLine()}28672&~this.PPUAddress?this.PPUAddress+=4096:(this.PPUAddress&=36863,928==(992&this.PPUAddress)?this.PPUAddress=64543&(2048^this.PPUAddress):992&~this.PPUAddress?this.PPUAddress+=32:this.PPUAddress&=64543)}else if(8<=this.PpuY&&this.PpuY<232)for(s=this.PpuY-8<<10,i=this.PaletteTable[this.Palette[16]],e=0;e<256;e++,s+=4)this.ImageData.data[s]=i[0],this.ImageData.data[s+1]=i[1],this.ImageData.data[s+2]=i[2]}else this.ctx.putImageData(this.ImageData,0,0),this.DrawFlag=!0,this.ScrollRegisterFlag=!1,this.IO1[2]&=31,this.IO1[2]|=128,this.toNMI=!(128&~this.IO1[0])}if(this.Sprite0Line&&64&~this.IO1[2])for(var a=this.PpuX>255?255:this.PpuX;t<=a;t++)if(0===this.SpriteLineBuffer[t]){this.IO1[2]|=64;break}},h.prototype.BuildBGLine=function(){var t,e=this.BgLineBuffer;if(8&~this.IO1[1])for(t=0;t<264;t++)e[t]=16;else if(this.Mapper.BuildBGLine(),2&~this.IO1[1])for(t=0;t<8;t++)e[t]=16},h.prototype.BuildBGLine_SUB=function(){for(var t=this.BgLineBuffer,e=this.VRAM,s=8192|4095&this.PPUAddress,i=(28672&this.PPUAddress)>>12|(16&this.IO1[0])<<8,h=s>>10,r=1023&s,a=e[h],o=this.PaletteArray,n=this.SPBitArray,d=0,c=this.HScrollTmp,u=0;u<33;u++){var P=a[r]<<4|i,p=e[P>>10];P&=1023;for(var A=a[(896&r)>>4|960+((28&r)>>2)]<<2>>((64&r)>>4|2&r)&12,C=n[p[P]][p[P+8]];c<8;c++,d++)t[d]=o[C[c]|A];c=0,31&~r?r++:(r&=65504,a=e[h^=1])}},h.prototype.BuildSpriteLine=function(){this.Mapper.BuildSpriteLine()},h.prototype.BuildSpriteLine_SUB=function(){var t=this.BgLineBuffer,e=4&~this.IO1[1]?8:0;if(!(16&~this.IO1[1])){for(var s=this.SpriteLineBuffer,i=0;i<256;i++)s[i]=256;for(var h=this.SPRITE_RAM,r=32&~this.IO1[0]?8:16,a=(8&this.IO1[0])<<9,o=this.VRAM,n=this.SPBitArray,d=this.PpuY,c=0,u=0;u<=252;u+=4){var P=h[u]+1;if(!(P>d||P+r<=d)){if(0===u&&(this.Sprite0Line=!0),9===++c)break;var p=h[u+3],A=p+8;A>256&&(A=256);var C,_,R=h[u+2],S=(3&R)<<2|16,l=!(32&R),f=128&~R?d-P:r-1-(d-P),G=((8&f)<<1)+(7&f)+(8===r?(h[u+1]<<4)+a:((254&h[u+1])<<4)+((1&h[u+1])<<12)),b=o[G>>10],y=1023&G,E=n[b[y]][b[y+8]];for(64&R?(C=7,_=-1):(C=0,_=1);p<A;p++,C+=_){var M=E[C];0!==M&&256===s[p]&&(s[p]=u,p>=e&&(l||16===t[p])&&(t[p]=M|S))}}}c>=8?this.IO1[2]|=32:this.IO1[2]&=223}},h.prototype.WriteScrollRegister=function(t){this.IO1[5]=t,this.ScrollRegisterFlag?this.PPUAddressBuffer=35871&this.PPUAddressBuffer|(248&t)<<2|(7&t)<<12:(this.PPUAddressBuffer=65504&this.PPUAddressBuffer|(248&t)>>3,this.HScrollTmp=7&t),this.ScrollRegisterFlag=!this.ScrollRegisterFlag},h.prototype.WritePPUControlRegister0=function(t){this.IO1[0]=t,this.PPUAddressBuffer=62463&this.PPUAddressBuffer|(3&t)<<10},h.prototype.WritePPUControlRegister1=function(t){this.IO1[1]=t},h.prototype.WritePPUAddressRegister=function(t){this.IO1[6]=t,this.PPUAddressRegisterFlag?this.PPUAddress=this.PPUAddressBuffer=65280&this.PPUAddressBuffer|t:this.PPUAddressBuffer=255&this.PPUAddressBuffer|(63&t)<<8,this.PPUAddressRegisterFlag=!this.PPUAddressRegisterFlag},h.prototype.ReadPPUStatus=function(){var t=this.IO1[2];return this.IO1[2]&=31,this.ScrollRegisterFlag=!1,this.PPUAddressRegisterFlag=!1,t},h.prototype.ReadPPUData=function(){return this.Mapper.ReadPPUData()},h.prototype.ReadPPUData_SUB=function(){var t=this.PPUReadBuffer,e=16383&this.PPUAddress;return this.PPUReadBuffer=this.VRAM[e>>10][1023&e],this.PPUAddress=this.PPUAddress+(4&~this.IO1[0]?1:32)&65535,t},h.prototype.WritePPUData=function(t){this.Mapper.WritePPUData(t)},h.prototype.WritePPUData_SUB=function(t){this.IO1[7]=t;var e=16383&this.PPUAddress;if(this.VRAM[e>>10][1023&e]=t,e<12288)this.PPUAddress=this.PPUAddress+(4&~this.IO1[0]?1:32)&65535;else{if(e<16127)return this.VRAM[e-4096>>10][e-4096&1023]=t,void(this.PPUAddress=this.PPUAddress+(4&~this.IO1[0]?1:32)&65535);var s=31&e;0===s||16===s?this.Palette[0]=this.Palette[16]=63&t:this.Palette[s]=63&t,this.PPUAddress=this.PPUAddress+(4&~this.IO1[0]?1:32)&65535}},h.prototype.WriteSpriteData=function(t){this.SPRITE_RAM[this.IO1[3]]=t,this.IO1[3]=this.IO1[3]+1&255},h.prototype.WriteSpriteAddressRegister=function(t){this.IO1[3]=t},h.prototype.StartDMA=function(t){for(var e=t<<8,s=this.SPRITE_RAM,i=this.RAM,h=0;h<256;h++,e++)s[h]=i[e];this.CPUClock+=514},h.prototype.StorageClear=function(){var t,e;for(t=0;t<this.RAM.length;t++)this.RAM[t]=0;for(t=0;t<this.SRAM.length;t++)this.SRAM[t]=0;for(t=0;t<this.PRGROM_STATE.length;t++)this.PRGROM_STATE[t]=0;for(t=0;t<this.CHRROM_STATE.length;t++)this.CHRROM_STATE[t]=0;for(t=0;t<this.VRAMS.length;t++){for(e=0;e<this.VRAMS[t].length;e++)this.VRAMS[t][e]=0;this.SetChrRomPage1K(t,t+256)}for(t=0;t<this.SPRITE_RAM.length;t++)this.SPRITE_RAM[t]=0;for(t=0;t<4;t++)this.SetPrgRomPage8K(t,-(t+1));for(t=0;t<this.IO1.length;t++)this.IO1[t]=0;for(t=0;t<this.IO2.length;t++)this.IO2[t]=0;this.IO2[23]=64},h.prototype.SetRom=function(t){if(!(t instanceof ArrayBuffer))return!1;for(var e=new Uint8Array(t),s=[],i=0;i<e.length;i++)s.push(e[i]);return 78===s[0]&&69===s[1]&&83===s[2]&&26===s[3]&&(this.Rom=s.concat(0),!0)},h.prototype.StorageInit=function(){this.PRGROM_PAGES=null,this.CHRROM_PAGES=null;var t;if(this.PrgRomPageCount>0)for(this.PRGROM_PAGES=new Array(2*this.PrgRomPageCount),t=0;t<2*this.PrgRomPageCount;t++){var e=16+8192*t;this.PRGROM_PAGES[t]=this.Rom.slice(e,e+8192)}if(this.ChrRomPageCount>0)for(this.CHRROM_PAGES=new Array(8*this.ChrRomPageCount),t=0;t<8*this.ChrRomPageCount;t++){var s=16+16384*this.PrgRomPageCount+1024*t;this.CHRROM_PAGES[t]=this.Rom.slice(s,s+4096)}},h.prototype.Get=function(t){switch(57344&t){case 0:return this.RAM[2047&t];case 8192:switch(7&t){case 0:case 1:case 2:return this.ReadPPUStatus();case 3:case 4:case 5:case 6:case 7:return this.ReadPPUData()}return 0;case 16384:if(t>=16416)return this.Mapper.ReadLow(t);switch(t){case 16406:return this.ReadJoyPadRegister1();case 16407:return this.ReadJoyPadRegister2();default:return 64}case 24576:return this.Mapper.ReadSRAM(t);case 32768:return this.ROM[0][8191&t];case 40960:return this.ROM[1][8191&t];case 49152:return this.ROM[2][8191&t];case 57344:return this.ROM[3][8191&t]}},h.prototype.Get16=function(t){return this.Get(t)|this.Get(t+1)<<8},h.prototype.Set=function(t,e){switch(57344&t){case 0:return void(this.RAM[2047&t]=e);case 8192:switch(7&t){case 0:return void this.WritePPUControlRegister0(e);case 1:return void this.WritePPUControlRegister1(e);case 2:return;case 3:return void this.WriteSpriteAddressRegister(e);case 4:return void this.WriteSpriteData(e);case 5:return void this.WriteScrollRegister(e);case 6:return void this.WritePPUAddressRegister(e);case 7:return void this.WritePPUData(e)}return;case 16384:if(t<16416)switch(this.IO2[255&t]=e,t){case 16404:return void this.StartDMA(e);case 16406:return void this.WriteJoyPadRegister1(e);default:return}return void this.Mapper.WriteLow(t,e);case 24576:return void this.Mapper.WriteSRAM(t,e);case 32768:case 40960:case 49152:case 57344:return void this.Mapper.Write(t,e)}},h.prototype.SetPrgRomPage8K=function(t,e){e<0?(this.PRGROM_STATE[t]=e,this.ROM[t]=this.ZEROS_ROM_PAGE):(this.PRGROM_STATE[t]=e%(2*this.PrgRomPageCount),this.ROM[t]=this.PRGROM_PAGES[this.PRGROM_STATE[t]])},h.prototype.SetPrgRomPages8K=function(t,e,s,i){this.SetPrgRomPage8K(0,t),this.SetPrgRomPage8K(1,e),this.SetPrgRomPage8K(2,s),this.SetPrgRomPage8K(3,i)},h.prototype.SetPrgRomPage=function(t,e){this.SetPrgRomPage8K(2*t,2*e),this.SetPrgRomPage8K(2*t+1,2*e+1)},h.prototype.WriteJoyPadRegister1=function(t){var e=!(1&~t);this.JoyPadStrobe&&!e&&(this.JoyPadBuffer[0]=this.JoyPadState[0],this.JoyPadBuffer[1]=this.JoyPadState[1]),this.JoyPadStrobe=e},h.prototype.ReadJoyPadRegister1=function(){var t=1&this.JoyPadBuffer[0];return this.JoyPadBuffer[0]>>>=1,t},h.prototype.ReadJoyPadRegister2=function(){var t=1&this.JoyPadBuffer[1];return this.JoyPadBuffer[1]>>>=1,t},h.prototype._keyCodeToBitCode=function(t){var e={player:null,flag:null};switch(t){case 90:e.player=this.JOYPAD_1P,e.flag=this.BUTTON_A;break;case 88:e.player=this.JOYPAD_1P,e.flag=this.BUTTON_B;break;case 16:e.player=this.JOYPAD_1P,e.flag=this.BUTTON_SELECT;break;case 13:e.player=this.JOYPAD_1P,e.flag=this.BUTTON_START;break;case 38:e.player=this.JOYPAD_1P,e.flag=this.BUTTON_UP;break;case 40:e.player=this.JOYPAD_1P,e.flag=this.BUTTON_DOWN;break;case 37:e.player=this.JOYPAD_1P,e.flag=this.BUTTON_LEFT;break;case 39:e.player=this.JOYPAD_1P,e.flag=this.BUTTON_RIGHT;break;case 105:e.player=this.JOYPAD_2P,e.flag=this.BUTTON_A;break;case 103:e.player=this.JOYPAD_2P,e.flag=this.BUTTON_B;break;case 104:e.player=this.JOYPAD_2P,e.flag=this.BUTTON_UP;break;case 98:e.player=this.JOYPAD_2P,e.flag=this.BUTTON_DOWN;break;case 100:e.player=this.JOYPAD_2P,e.flag=this.BUTTON_LEFT;break;case 102:e.player=this.JOYPAD_2P,e.flag=this.BUTTON_RIGHT}return e},h.prototype.handleKeyUp=function(t){var e=this._keyCodeToBitCode(t.keyCode),s=e.player,i=e.flag;s===this.JOYPAD_1P&&this.isConnectedGamePad1P||s===this.JOYPAD_2P&&this.isConnectedGamePad2P||(null!==s&&(this.JoyPadState[s]&=~i),t.preventDefault())},h.prototype.handleKeyDown=function(t){var e=this._keyCodeToBitCode(t.keyCode),s=e.player,i=e.flag;s===this.JOYPAD_1P&&this.isConnectedGamePad1P||s===this.JOYPAD_2P&&this.isConnectedGamePad2P||(null!==s&&(this.JoyPadState[s]|=i),t.preventDefault())},h.prototype._buttonIDToBitCode=function(t){var e=null;switch(t){case 0:e=this.BUTTON_A;break;case 1:e=this.BUTTON_B;break;case 8:e=this.BUTTON_SELECT;break;case 9:e=this.BUTTON_START}return e},h.prototype._handleGamePads=function(){if("undefined"!=typeof window&&window.Gamepad&&window.navigator.getGamepads){var t=navigator.getGamepads(),e=t[0],s=t[1];e?(this.isConnectedGamePad1P=!0,this._handleGamePad(this.JOYPAD_1P,e)):this.isConnectedGamePad1P=!1,s?(this.isConnectedGamePad2P=!0,this._handleGamePad(this.JOYPAD_2P,s)):this.isConnectedGamePad2P=!1}},h.prototype._handleGamePad=function(t,e){this.JoyPadState[t]=0;for(var s=0;s<e.buttons.length;s++){var i=this._buttonIDToBitCode(s);null!==i&&(e.buttons[s].pressed?this.JoyPadState[t]|=i:this.JoyPadState[t]&=~i)}e.axes[1]<-.5?this.JoyPadState[t]|=this.BUTTON_UP:this.JoyPadState[t]&=~this.BUTTON_UP,e.axes[1]>-.5?this.JoyPadState[t]|=this.BUTTON_DOWN:this.JoyPadState[t]&=~this.BUTTON_DOWN,e.axes[0]<-.5?this.JoyPadState[t]|=this.BUTTON_LEFT:this.JoyPadState[t]&=~this.BUTTON_LEFT,e.axes[0]>.5?this.JoyPadState[t]|=this.BUTTON_RIGHT:this.JoyPadState[t]&=~this.BUTTON_RIGHT},h.prototype.ReadWaveControl=function(){return 0},h.prototype.WriteWaveControl=function(){},h.prototype.WriteCh1Length0=function(){this.WaveCh1Frequency=((7&this.IO2[3])<<8)+this.IO2[2]+1},h.prototype.WriteCh1Length1=function(){this.WaveCh1LengthCounter=this.WaveLengthCount[this.IO2[3]>>3],this.WaveCh1Envelope=0,this.WaveCh1EnvelopeCounter=15,this.WaveCh1Sweep=0,this.WaveCh1Frequency=((7&this.IO2[3])<<8)+this.IO2[2]+1},h.prototype.WriteCh2Length0=function(){this.WaveCh2Frequency=((7&this.IO2[7])<<8)+this.IO2[6]+1},h.prototype.WriteCh2Length1=function(){this.WaveCh2LengthCounter=this.WaveLengthCount[this.IO2[7]>>3],this.WaveCh2Envelope=0,this.WaveCh2EnvelopeCounter=15,this.WaveCh2Sweep=0,this.WaveCh2Frequency=((7&this.IO2[7])<<8)+this.IO2[6]+1},h.prototype.WriteCh3LinearCounter=function(){this.WaveCh3LinearCounter=127&this.IO2[8]},h.prototype.WriteCh3Length1=function(){this.WaveCh3LengthCounter=this.WaveLengthCount[this.IO2[11]>>3],this.WaveCh3LinearCounter=127&this.IO2[8]},h.prototype.WriteCh4Length1=function(){this.WaveCh4LengthCounter=this.WaveLengthCount[this.IO2[15]>>3],this.WaveCh4Envelope=0,this.WaveCh4EnvelopeCounter=15},h.prototype.WriteCh5DeltaControl=function(){128&~this.IO2[16]&&(this.toIRQ&=-129)},h.prototype.WriteCh5DeltaCounter=function(){this.WaveCh5DeltaCounter=127&this.IO2[17]},h.prototype.SetCh5Delta=function(){var t=this.IO2;this.WaveCh5DeltaCounter=127&t[17],this.WaveCh5SampleAddress=t[18]<<6,this.WaveCh5SampleCounter=1+(t[19]<<4)<<3,this.WaveCh5Register=0,this.WaveCh5Angle=-1,this.toIRQ&=-129},h.prototype.ApuInit=function(){this.WaveDatas=[]},h.prototype.Out_Apu=function(){return 0},h.prototype.WaveFrameSequencer=function(t){},h.prototype.ApuRun=function(){},h.prototype.WaveCh1_2_3_4_Length_WaveCh1_2_Sweep=function(){var t=this.IO2;32&t[0]||0===this.WaveCh1LengthCounter||0===--this.WaveCh1LengthCounter&&(t[21]&=254),32&t[4]||0===this.WaveCh2LengthCounter||0===--this.WaveCh2LengthCounter&&(t[21]&=253),128&t[8]||0===this.WaveCh3LengthCounter||0===--this.WaveCh3LengthCounter&&(t[21]&=251),32&t[12]||0===this.WaveCh4LengthCounter||0===--this.WaveCh4LengthCounter&&(t[21]&=247),++this.WaveCh1Sweep===1+((112&t[1])>>4)&&(this.WaveCh1Sweep=0,!(128&~t[1])&&7&t[1]&&0!==this.WaveCh1LengthCounter&&(8&t[1]?this.WaveCh1Frequency-=this.WaveCh1Frequency>>(7&t[1]):this.WaveCh1Frequency+=this.WaveCh1Frequency>>(7&t[1]),(this.WaveCh1Frequency<8||this.WaveCh1Frequency>2047)&&(this.WaveCh1LengthCounter=0,t[21]&=254))),++this.WaveCh2Sweep===1+((112&t[5])>>4)&&(this.WaveCh2Sweep=0,!(128&~t[5])&&7&t[5]&&0!==this.WaveCh2LengthCounter&&(8&t[5]?this.WaveCh2Frequency-=this.WaveCh2Frequency>>(7&t[5]):this.WaveCh2Frequency+=this.WaveCh2Frequency>>(7&t[5]),(this.WaveCh2Frequency<8||this.WaveCh2Frequency>2047)&&(this.WaveCh2LengthCounter=0,t[21]&=253)))},h.prototype.WaveCh1_2_4_Envelope_WaveCh3_Linear=function(){var t=this.IO2;16&t[0]||++this.WaveCh1Envelope===1+(15&t[0])&&(this.WaveCh1Envelope=0,0===this.WaveCh1EnvelopeCounter?32&~t[0]||(this.WaveCh1EnvelopeCounter=15):this.WaveCh1EnvelopeCounter--),16&t[4]||++this.WaveCh2Envelope===1+(15&t[4])&&(this.WaveCh2Envelope=0,0===this.WaveCh2EnvelopeCounter?32&~t[4]||(this.WaveCh2EnvelopeCounter=15):this.WaveCh2EnvelopeCounter--),16&t[12]||++this.WaveCh4Envelope===1+(15&t[12])&&(this.WaveCh4Envelope=0,0===this.WaveCh4EnvelopeCounter?32&~t[12]||(this.WaveCh4EnvelopeCounter=15):this.WaveCh4EnvelopeCounter--),128&t[8]||0===this.WaveCh3LinearCounter||this.WaveCh3LinearCounter--},h.prototype.EXSoundInit=function(){this.Init_FDS(),this.Init_MMC5(),this.Init_VRC6(),this.Init_N163(),this.Init_AY()},h.prototype.Init_FDS=function(){var t;for(t=0;t<this.FDS_WAVE_REG.length;t++)this.FDS_WAVE_REG[t]=0;for(t=0;t<this.FDS_LFO_REG.length;t++)this.FDS_LFO_REG[t]=0;for(t=0;t<this.FDS_REG.length;t++)this.FDS_REG[t]=0;this.FDS_WaveIndexCounter=0,this.FDS_WaveIndex=0,this.FDS_LFOIndexCounter=0,this.FDS_LFOIndex=0,this.FDS_REGAddress=0,this.FDS_VolumeEnvCounter=0,this.FDS_VolumeEnv=0,this.FDS_SweepEnvCounter=0,this.FDS_SweepEnv=0,this.FDS_SweepBias=0,this.FDS_Volume=0},h.prototype.Write_FDS_WAVE_REG=function(t,e){128&~this.FDS_REG[9]||(this.FDS_WAVE_REG[t]=63&e)},h.prototype.Write_FDS_REG=function(t,e){switch(this.FDS_REG[t]=e,t){case 0:128&~e||(this.FDS_VolumeEnv=63&e),this.FDS_VolumeEnvCounter=0;break;case 3:128&~e||(this.FDS_WaveIndex=0);break;case 4:128&~e||(this.FDS_SweepEnv=63&e),this.FDS_SweepEnvCounter=0;break;case 5:this.FDS_SweepBias=127&e,this.FDS_SweepBias>=64&&(this.FDS_SweepBias=this.FDS_SweepBias-128),this.FDS_REGAddress=0;break;case 7:this.FDS_LFOIndexCounter=0,this.FDS_LFOIndex=0;break;case 8:128&~this.FDS_REG[7]||(this.FDS_LFO_REG[this.FDS_REGAddress]=7&e,this.FDS_REGAddress=this.FDS_REGAddress+1&31)}},h.prototype.Count_FDS=function(t){if(64&~this.FDS_REG[3]){var e;if((192&this.FDS_REG[0])<128&&(e=this.FDS_REG[10]*(1+(63&this.FDS_REG[0]))*8)>0)for(this.FDS_VolumeEnvCounter+=t;this.FDS_VolumeEnvCounter>=e;)this.FDS_VolumeEnvCounter-=e,64&this.FDS_REG[0]?this.FDS_VolumeEnv<32&&this.FDS_VolumeEnv++:this.FDS_VolumeEnv>0&&this.FDS_VolumeEnv--;if((192&this.FDS_REG[4])<128&&(e=this.FDS_REG[10]*(1+(63&this.FDS_REG[4]))*8)>0)for(this.FDS_SweepEnvCounter+=t;this.FDS_SweepEnvCounter>=e;)this.FDS_SweepEnvCounter-=e,64&this.FDS_REG[4]?this.FDS_SweepEnv<63&&this.FDS_SweepEnv++:this.FDS_SweepEnv>0&&this.FDS_SweepEnv--}var s;if(128&~this.FDS_REG[7])for(s=this.FDS_REG[6]|(15&this.FDS_REG[7])<<8,this.FDS_LFOIndexCounter+=s*t;this.FDS_LFOIndexCounter>=65536;){this.FDS_LFOIndexCounter-=65536;var i=this.FDS_LFO_REG[this.FDS_LFOIndex>>1];this.FDS_SweepBias+=this.FDS_LFO_DATA[i],4===i&&(this.FDS_SweepBias=0),this.FDS_SweepBias>63?this.FDS_SweepBias-=128:this.FDS_SweepBias<-64&&(this.FDS_SweepBias+=128),this.FDS_LFOIndex+=1,this.FDS_LFOIndex>63&&(this.FDS_LFOIndex=0)}var h=this.FDS_SweepBias*this.FDS_SweepEnv,r=15&h;h>>=4,r>0&&(this.FDS_SweepBias<0?h-=1:h+=2),h>=192?h-=256:h<-64&&(h+=256),h*=s=this.FDS_REG[2]|(15&this.FDS_REG[3])<<8,s+=h>>=6,this.FDS_WaveIndexCounter+=s*t,this.FDS_WaveIndex+=this.FDS_WaveIndexCounter>>16,this.FDS_WaveIndexCounter&=65535,this.FDS_WaveIndex>63&&(this.FDS_WaveIndex&=63,this.FDS_Volume=this.FDS_VolumeEnv)},h.prototype.Out_FDS=function(){return 128&~this.FDS_REG[3]?(this.FDS_WAVE_REG[this.FDS_WaveIndex]-32)*this.FDS_Volume>>1:0},h.prototype.Init_MMC5=function(){this.MMC5_FrameSequenceCounter=0,this.MMC5_FrameSequence=0;for(var t=0;t<this.MMC5_REG.length;t++)this.MMC5_REG[t]=0;this.MMC5_Ch[0]={LengthCounter:0,Envelope:0,EnvelopeCounter:0,Sweep:0,Frequency:0},this.MMC5_Ch[1]={LengthCounter:0,Envelope:0,EnvelopeCounter:0,Sweep:0,Frequency:0}},h.prototype.Write_MMC5_ChLength0=function(t){var e=t<<2;this.MMC5_Ch[t].Frequency=((7&this.MMC5_REG[e+3])<<8)+this.MMC5_REG[e+2]+1},h.prototype.Write_MMC5_ChLength1=function(t){var e=t<<2;this.MMC5_Ch[t].LengthCounter=this.WaveLengthCount[this.MMC5_REG[e+3]>>3],this.MMC5_Ch[t].Envelope=0,this.MMC5_Ch[t].EnvelopeCounter=15,this.MMC5_Ch[t].Sweep=0,this.MMC5_Ch[t].Frequency=((7&this.MMC5_REG[e+3])<<8)+this.MMC5_REG[e+2]+1},h.prototype.Write_MMC5_REG=function(t,e){switch(this.MMC5_REG[t]=e,t){case 2:this.Write_MMC5_ChLength0(0);break;case 3:this.Write_MMC5_ChLength1(0);break;case 6:this.Write_MMC5_ChLength0(1);break;case 7:this.Write_MMC5_ChLength1(1);break;case 21:for(var s=0;s<2;s++)this.MMC5_REG[21]&1<<s||(this.MMC5_Ch[s].LengthCounter=0)}},h.prototype.Read_MMC5_REG=function(t){if(21===t)for(var e=0;e<2;e++)this.MMC5_Ch[e].LengthCounter},h.prototype.Count_MMC5=function(t){var e,s;if(this.MMC5_FrameSequenceCounter+=240*t,this.MMC5_FrameSequenceCounter>=this.MainClock){for(this.MMC5_FrameSequenceCounter-=this.MainClock,e=0;e<2;e++)s=e<<2,16&this.MMC5_REG[s]||++this.MMC5_Ch[e].Envelope===1+(15&this.MMC5_REG[s])&&(this.MMC5_Ch[e].Envelope=0,0===this.MMC5_Ch[e].EnvelopeCounter?32&~this.MMC5_REG[s]||(this.MMC5_Ch[e].EnvelopeCounter=15):this.MMC5_Ch[e].EnvelopeCounter--);if(1===this.MMC5_FrameSequence||3===this.MMC5_FrameSequence)for(e=0;e<2;e++)s=e<<2,32&this.MMC5_REG[s]||0===this.MMC5_Ch[e].LengthCounter||0===--this.MMC5_Ch[e].LengthCounter&&(this.MMC5_REG[21]&=~(1<<e)),++this.MMC5_Ch[e].Sweep===1+((112&this.MMC5_REG[s+1])>>4)&&(this.MMC5_Ch[e].Sweep=0,!(128&~this.MMC5_REG[s+1])&&7&this.MMC5_REG[s+1]&&0!==this.MMC5_Ch[e].LengthCounter&&(8&this.MMC5_REG[s+1]?this.MMC5_Ch[e].Frequency-=this.MMC5_Ch[e].Frequency>>(7&this.MMC5_REG[s+1]):this.MMC5_Ch[e].Frequency+=this.MMC5_Ch[e].Frequency>>(7&this.MMC5_REG[s+1]),(this.MMC5_Ch[e].Frequency<8||this.MMC5_Ch[e].Frequency>2047)&&(this.MMC5_Ch[e].LengthCounter=0,this.MMC5_REG[21]&=~(1<<e))));this.MMC5_FrameSequence=3&++this.MMC5_FrameSequence}},h.prototype.Out_MMC5=function(){for(var t=0,e=this.WaveBaseCount<<1,s=0;s<2;s++){var i=s<<2;0!==this.MMC5_Ch[s].LengthCounter&&this.MMC5_Ch[s].Frequency>3&&(t+=(16&~this.MMC5_REG[i]?this.MMC5_Ch[s].EnvelopeCounter:15&this.MMC5_REG[i])*((e/this.MMC5_Ch[s].Frequency&31)<this.WaveCh1_2DutyData[(192&this.MMC5_REG[i])>>6]?1:-1))}return(t+=(this.MMC5_REG[17]>>2)-16)<<5},h.prototype.Init_VRC6=function(){for(var t=0;t<this.VRC6_REG.length;t++)this.VRC6_REG[t]=0;this.VRC6_Ch3_Counter=0,this.VRC6_Ch3_index=0},h.prototype.Write_VRC6_REG=function(t,e){this.VRC6_REG[t]=e},h.prototype.Count_VRC6=function(t){var e=1+((15&this.VRC6_REG[10])<<8|this.VRC6_REG[9]);this.VRC6_Ch3_Counter+=t,this.VRC6_Ch3_index+=this.VRC6_Ch3_Counter/e|0,this.VRC6_Ch3_index%=14,this.VRC6_Ch3_Counter%=e},h.prototype.Out_VRC6=function(){for(var t=0,e=this.WaveBaseCount,s=0;s<8;s+=4)if(!(128&~this.VRC6_REG[s+2]))if(128&this.VRC6_REG[s+0])t+=15&this.VRC6_REG[s+0];else{var i=(15&this.VRC6_REG[s+2])<<8|this.VRC6_REG[s+1],h=(112&this.VRC6_REG[s+0])>>>4;t+=(15&this.VRC6_REG[s+0])*((e/i&15)<h?1:-1)}return 128&~this.VRC6_REG[10]||(t+=((this.VRC6_Ch3_index>>>1)*(63&this.VRC6_REG[8])>>>3)-16),t<<5},h.prototype.Init_N163=function(){var t;for(t=0;t<this.N163_RAM.length;t++)this.N163_RAM[t]=0;for(t=0;t<this.N163_ch_data.length;t++)this.N163_ch_data[t]={Freq:0,Phase:0,Length:0,Address:0,Vol:0};this.N163_Address=0,this.N163_ch=0,this.N163_Clock=0},h.prototype.Write_N163_RAM=function(t){var e=127&this.N163_Address;if(this.N163_RAM[e]=t,e>=64){var s=e>>>3&7;switch(7&e){case 0:this.N163_ch_data[s].Freq=261888&this.N163_ch_data[s].Freq|t;break;case 1:this.N163_ch_data[s].Phase=16776960&this.N163_ch_data[s].Freq|t;break;case 2:this.N163_ch_data[s].Freq=196863&this.N163_ch_data[s].Freq|t<<8;break;case 3:this.N163_ch_data[s].Phase=16711935&this.N163_ch_data[s].Freq|t<<8;break;case 4:this.N163_ch_data[s].Freq=65535&this.N163_ch_data[s].Freq|(3&t)<<16,this.N163_ch_data[s].Length=256-(252&t)<<16;break;case 5:this.N163_ch_data[s].Phase=65535&this.N163_ch_data[s].Freq|t<<16;break;case 6:this.N163_ch_data[s].Address=t;break;case 7:this.N163_ch_data[s].Vol=15&t,127===e&&(this.N163_ch=t>>>4&7)}}128&~this.N163_Address||(this.N163_Address=1+(127&this.N163_Address)|128)},h.prototype.Read_N163_RAM=function(){var t=this.N163_RAM[127&this.N163_Address];return 128&~this.N163_Address||(this.N163_Address=1+(127&this.N163_Address)|128),t},h.prototype.Count_N163=function(t){this.N163_Clock+=t;for(var e=15*(this.N163_ch+1);this.N163_Clock>=e;){this.N163_Clock-=e;for(var s=7-this.N163_ch;s<8;s++)this.N163_ch_data[s].Length>0&&(this.N163_ch_data[s].Phase=(this.N163_ch_data[s].Phase+this.N163_ch_data[s].Freq)%this.N163_ch_data[s].Length)}},h.prototype.Out_N163=function(){for(var t=0,e=7-this.N163_ch;e<8;e++){var s=this.N163_ch_data[e].Address+(this.N163_ch_data[e].Phase>>16)&255,i=this.N163_RAM[s>>>1];t+=((i=1&s?i>>>4:15&i)-8)*this.N163_ch_data[e].Vol}return t<<2},h.prototype.Init_AY=function(){this.AY_ClockCounter=0;for(var t=0;t<this.AY_REG.length;t++)this.AY_REG[t]=0;this.AY_Noise_Seed=1,this.AY_Noise_Angle=0,this.AY_Env_Counter=0,this.AY_Env_Index=0,this.AY_REG_Select=0},h.prototype.Select_AY_REG=function(t){this.AY_REG_Select=15&t},h.prototype.Write_AY_REG=function(t){this.AY_REG[this.AY_REG_Select]=t,13===this.AY_REG_Select&&(this.AY_Env_Index=0)},h.prototype.Read_AY_REG=function(){return 0},h.prototype.Count_AY=function(t){this.AY_Env_Counter+=t;var e=8*(1+(this.AY_REG[12]<<8|this.AY_REG[11])),s=this.AY_Env_Counter/e|0;this.AY_Env_Counter%=e,this.AY_Env_Index+=s,this.AY_Env_Index>=48&&(this.AY_Env_Index=(this.AY_Env_Index-48)%32+32)},h.prototype.Out_AY=function(){var t=this.WaveBaseCount,e=0,s=1&~this.AY_Noise_Seed?-1:1,i=t/(32*(1+(31&this.AY_REG[5])))|0;i!==this.AY_Noise_Angle&&(this.AY_Noise_Seed=this.AY_Noise_Seed>>>1|(1&this.AY_Noise_Seed)<<15^(8&this.AY_Noise_Seed)<<12,this.AY_Noise_Angle=i);for(var h=0;h<3;h++){var r=16&this.AY_REG[8+h]?this.AY_Env_Pattern[15&this.AY_REG[13]][this.AY_Env_Index]:15&this.AY_REG[8+h];if(r=this.AY_Env_Volume[r],!(this.AY_REG[7]>>h&1)){var a=1+((15&this.AY_REG[2*h+1])<<8|this.AY_REG[2*h]);e+=a>1?r*((t/a&31)<16?1:-1):r}this.AY_REG[7]>>h&8||(e+=r*s)}return e},h.prototype.webAudioContextResume=function(){this.canAudioContext&&this.WebAudioCtx.resume()},t.exports=h}},e={},s=function s(i){var h=e[i];if(void 0!==h)return h.exports;var r=e[i]={exports:{}};return t[i](r,r.exports,s),r.exports}(795),i=document.getElementById("mainCanvas"),h=i.width,r=i.height,a=new s(i);function o(t){a.Pause(),a.SetRom(t)?a.Init()&&a.Start():console.error("Can't get rom data (perhaps you don't set ArrayBuffer arguments or it's not nes rom format)")}function n(){var t=parseInt(window.innerHeight/r);i.style.width=h*t,i.style.height=r*t}a.initCanvas(),window.onkeydown=function(t){a.handleKeyDown(t)},window.onkeyup=function(t){a.handleKeyUp(t)},window.onload=function(){var t,e;window.addEventListener("resize",n),n(),t=o,(e=new XMLHttpRequest).onload=function(){t(e.response)},e.onerror=function(t){console.error("can't get rom binary")},e.open("GET","./rom/smb.nes",!0),e.responseType="arraybuffer",e.send(null)}})();